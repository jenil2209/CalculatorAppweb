@{
    ViewData["Title"] = "Calculator";
}

<div class="text-center">
    <h1 class="display-4">Simple Calculator</h1>
</div>

<div class="calculator">
    <input type="text" id="display" readonly>
    <button onclick="appendToDisplay('1')">1</button>
    <button onclick="appendToDisplay('2')">2</button>
    <button onclick="appendToDisplay('3')">3</button>
    <button onclick="appendToDisplay('+')">+</button>
    <br>
    <button onclick="appendToDisplay('4')">4</button>
    <button onclick="appendToDisplay('5')">5</button>
    <button onclick="appendToDisplay('6')">6</button>
    <button onclick="appendToDisplay('-')">-</button>
    <br>
    <button onclick="appendToDisplay('7')">7</button>
    <button onclick="appendToDisplay('8')">8</button>
    <button onclick="appendToDisplay('9')">9</button>
    <button onclick="appendToDisplay('*')">*</button>
    <br>
    <button onclick="appendToDisplay('0')">0</button>
    <button onclick="clearDisplay()">C</button>
    <button onclick="calculate()">=</button>

    <button onclick="appendToDisplay('/')">/</button>
</div>

<div class="result" id="result">
    <!-- Result will be displayed here -->
</div>

<div class="errorMessage" id="errorMessage">
    <!-- Error messages will be displayed here -->
</div>



@section Scripts {
    <script>
        function appendToDisplay(value) {
            document.getElementById('display').value += value;
        }

        function clearDisplay() {
            document.getElementById('display').value = '';
            document.getElementById('result').innerText = '';
        }

        function calculate() {
            let expression = document.getElementById('display').value;
            if (expression) {
                // Clear previous error message
                document.getElementById('errorMessage').innerText = '';

                // Send expression to the server for calculation
                fetch('/Home/Calculate', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ expression: expression })  // Make sure 'expression' matches the property name
                })
                    .then(response => response.json())
                    .then(data => {
                        if (data.success) {
                            document.getElementById('result').innerText = 'Result: ' + data.result;
                        } else {
                            document.getElementById('result').innerText = 'Error';
                            document.getElementById('errorMessage').innerText = data.error;
                        }
                    })
                    .catch(error => {
                        console.error('Error:', error);
                        document.getElementById('errorMessage').innerText = 'An error occurred.';
                    });
            }
        }

    </script>
}